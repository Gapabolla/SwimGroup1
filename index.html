<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <style>
        body {
            margin: 0;
            padding: 10px;
            background: var(--tg-theme-bg-color, #ffffff);
            color: var(--tg-theme-text-color, #000000);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        }

        .info-text {
            text-align: center;
            font-size: 13px;
            color: var(--tg-theme-hint-color, #888);
            margin-bottom: 10px;
        }

        .contact-btn {
            display: block;
            background: var(--tg-theme-button-color, #0088cc);
            color: var(--tg-theme-button-text-color, #ffffff);
            padding: 12px;
            text-decoration: none;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 15px;
            font-weight: 500;
            font-size: 16px;
        }

        .tabs {
            display: flex;
            background: var(--tg-theme-secondary-bg-color, #f4f4f4);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .tab {
            flex: 1;
            padding: 12px;
            text-align: center;
            cursor: pointer;
            font-weight: 500;
            transition: background 0.2s;
            user-select: none;
        }

        .tab.active {
            background: var(--tg-theme-button-color, #0088cc);
            color: var(--tg-theme-button-text-color, #ffffff);
        }

        iframe {
            width: 100%;
            height: 420px;
            border: none;
            border-radius: 12px;
            background: var(--tg-theme-secondary-bg-color, #f8f9fa);
        }
    </style>
</head>
<body>

    <div class="info-text">
        –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–≤–∏—Ç–∞–Ω—Ü–∏–∏
    </div>

    <a href="#"
       class="contact-btn"
       onclick="tg.openTelegramLink('https://t.me/semen_prozorov')">
        üìÑ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–≤–∏—Ç–∞–Ω—Ü–∏—é
    </a>

    <div class="tabs">
        <div class="tab active" onclick="switchSheet('attendance', this)">
            üìä –ü–æ—Å–µ—â–µ–Ω–∏–µ
        </div>
        <div class="tab" onclick="switchSheet('noReceipts', this)">
            ‚ùå –ù–µ—Ç —á–µ–∫–æ–≤
        </div>
        <div class="tab" onclick="switchSheet('sharks', this)">
            üêü –ê–∫—É–ª—è—Ç–∞
        </div>
    </div>

    <iframe id="sheetFrame"></iframe>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.ready();

        // ID –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω–æ–π Google –¢–∞–±–ª–∏—Ü—ã
        const SHEET_ID = "2PACX-1vRfKiesPxaRYiHMfRNT1NYa7H3th912IHJ1t2Mqt71Ht6oTXbyscLAQbtPzv7W3OrvuCy5qqYfS3Noq";

        // –†–µ–∞–ª—å–Ω—ã–µ gid –ª–∏—Å—Ç–æ–≤
        const SHEETS = {
            attendance: 0,          // 1 –ª–∏—Å—Ç
            noReceipts: 513068483,  // 2 –ª–∏—Å—Ç
            sharks: 207736853       // 3 –ª–∏—Å—Ç
        };

        function switchSheet(key, tabElement) {
            const iframe = document.getElementById("sheetFrame");
            const gid = SHEETS[key];

            iframe.src =
                `https://docs.google.com/spreadsheets/d/e/${SHEET_ID}/pubhtml` +
                `?gid=${gid}&single=true&rm=minimal&chrome=false`;

            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            tabElement.classList.add('active');
        }

        // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–≤—ã–π –ª–∏—Å—Ç –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ WebApp
        switchSheet('attendance', document.querySelector('.tab.active'));

        // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç (–µ—Å–ª–∏ WebApp –∞–∫—Ç–∏–≤–µ–Ω)
        setInterval(() => {
            if (document.visibilityState === 'visible') {
                const iframe = document.getElementById("sheetFrame");
                iframe.src = iframe.src;
            }
        }, 300000);
    </script>

</body>
</html>
